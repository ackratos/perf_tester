Borrowed from github.com/scala/scala - licensed under scala standard license.
